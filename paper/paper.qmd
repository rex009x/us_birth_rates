---
title: "A Deeper Analysis into the Trends and Factors of the US's Declining Birth Rates"
#subtitle: "My subtitle if needed"
author: Maroosh Gillani, Aaron Liu & Jimmy Luc
thanks: "Code and data are available at: https://github.com/rex009x/us_birth_rates/tree/master/data. Selected aspects of the original paper that underpins this paper were reproduced and a record of this is available at: https://www.socialsciencereproduction.org/reproductions/bfe97499-4c05-466f-8cb5-fbedc27a83a1/index "
date: today
date-format: long
abstract: "Over the last couple of years, the American population has been witnessing a steady decline in their birth rates, as suggested by [@citeOriginalReplication]'s data from the American Economic Association. Through the analysis of multiple different factors, such as age and education, we notice a continual decline in birth rate starting from the year 2007. We explore how different social, cultural, and economic effects play a part in this worrying trend. This report sheds light on how the societal trends in the recent years have affected the American citizens in the last few decades, and how these patterns have played a part in this downward trend as people adapt to them."
format:
  pdf:
    fig-pos: "H"
toc: true
number-sections: true
bibliography: references.bib
---
```{r, include=FALSE, warning=FALSE, message=FALSE}
# workplace setup


library(tidyverse)
library(dplyr)
library(ggplot2)
library(here)
library(haven)

# acquire fig 1 data from fig_1.csv
fig_1_data <- 
  read.csv(file=here("data/fig_1.csv"))

# acquire fig 2a data from figs_2a_2b.csv
fig_2a_data <-
  read.csv((file=here("data/figs_2a_2b.csv")))

fig_2a_data <- fig_2a_data %>% select(year, brate_1519, brate_2024, brate_2529, brate_3034, brate_3539, brate_4044)

fig_2a_data_long <- fig_2a_data %>%
  pivot_longer(cols = -year, names_to = "Age_Group", values_to = "Birth_Rate")

# acquire fig 2d data from figs_1_2_3.csv
fig_2d_data <-
  read.csv((file=here("data/figs_1_2_3.csv")))

fig_2d_data <- fig_2d_data %>% select(year, brate_hsdropout,	brate_hsgrad,	brate_somecol,	brate_colgrad)

fig_2d_data <- na.omit(fig_2d_data)

fig_2d_data_long <- fig_2d_data %>%
  pivot_longer(cols = -year, names_to = "Education_Level", values_to = "Birth_Rate")

# acquire figure 2F data from NCHS Natality Microdata's nchs_births_pop_1990_2019.dta and SEER's age_race_comp_seer.dta
nchs_births_data <- read_dta(here("data/nchs_births_pop_1990_2019.dta"))
seer_data <- read_dta(here("data/age_race_comp_seer.dta"))

merged_data <- merge(nchs_births_data, seer_data, by = c("stname", "year"))

merged_data <- merged_data %>%
  mutate(
    brate_firstbirth = merged_data$numbirth_firstbirth / merged_data$pop1544 * 1000,
    brate_secondbirth = merged_data$numbirth_secondbirth / merged_data$pop1544 * 1000,
    brate_thirdbirth = merged_data$numbirth_thirdbirth / merged_data$pop1544 * 1000,
    brate_fourthbirth = merged_data$numbirth_fourthbirth / merged_data$pop1544 * 1000
  ) %>%
  select(year, starts_with("brate_"))

merged_data_long <- merged_data %>%
  pivot_longer(cols = -year, names_to = "Parity", values_to = "Birth_Rate")

# acquire fig 5 data from nchs_cohort_analysis.dta
# acquire figure 5 data from CDC SEER's agecomp-seer.dta
seer_cohort_data <- 
  read_dta(here("data/agecomp-seer.dta"))

nchs_cohort_data <- 
  read_dta(here("data/nchs_cohort_analysis.dta"))

# code to replicate figure 5 from: https://github.com/KCtt457/us-birth-rates-decline
# Process population data to aggregate by cohort
fig5_pop_data1 <- seer_cohort_data %>%
  select(1:32) %>%
  select(-c(stname)) %>%
  group_by(year) %>%
  summarise(across(everything(),sum)) # https://stackoverflow.com/questions/1660124/how-to-sum-a-variable-by-group

fig5_pop_data1 <- fig5_pop_data1 %>%
  pivot_longer(-c(year), names_to = "mage", values_to = "pop")

fig5_pop_data1 <- fig5_pop_data1 %>%
  mutate(mage = as.numeric(str_replace(mage, "fem", ""))) %>%
  mutate(cohort = year - mage) %>%
  mutate(cohort2 = case_when(cohort >= 1968 & cohort <=1972 ~ 1,
                             cohort >= 1973 & cohort <=1977 ~ 2,
                             cohort >= 1978 & cohort <=1982 ~ 3,
                             cohort >= 1983 & cohort <=1987 ~ 4,
                             cohort >= 1988 & cohort <=1992 ~ 5,
                             cohort >= 1993 & cohort <=1997 ~ 6)
         )

fig5_pop_data1 <- na.omit(fig5_pop_data1)
fig5_pop_data1 <- fig5_pop_data1 %>%
  group_by(cohort2, mage) %>%
  summarise(pop = sum(pop))

# Join dataframes for population and birth data
nchs_cohort_data <- full_join(nchs_cohort_data, fig5_pop_data1, by=c("mage", "cohort2")) %>%
  mutate(cohort_years = case_when(cohort2 == 1 ~ "1968-1972",
                                  cohort2 == 2 ~ "1973-1977",
                                  cohort2 == 3 ~ "1978-1982",
                                  cohort2 == 4 ~ "1983-1987",
                                  cohort2 == 5 ~ "1988-1992",
                                  cohort2 == 6 ~ "1993-1997")
         )

# Calculate birth rates
nchs_cohort_data <- nchs_cohort_data %>%
  mutate(brate=numbirth/pop*1000,
         age_20_24_year = case_when(cohort2 == 1 ~ 1992,
                                    cohort2 == 2 ~ 1997,
                                    cohort2 == 3 ~ 2002,
                                    cohort2 == 4 ~ 2007,
                                    cohort2 == 5 ~ 2012,
                                    cohort2 == 6 ~ 2017)
         )

# Calculate cumulative birth rates for each cohort
nchs_cohort_data <- nchs_cohort_data %>%
  group_by(cohort2) %>%
  mutate(cum_brate = cumsum(brate)/1000, 
         cohort_years = case_when(cohort2 == 1 ~ "1968-1972",
                                  cohort2 == 2 ~ "1973-1977",
                                  cohort2 == 3 ~ "1978-1982",
                                  cohort2 == 4 ~ "1983-1987",
                                  cohort2 == 5 ~ "1988-1992",
                                  cohort2 == 6 ~ "1993-1997")
         ) 

```

\newpage
# Introduction

The United States has been experiencing heavy fluctuations in birth rates for nearly half a century with constant decline since 2007. The birth rate of a country is representative of its socioeconomic state, political state, and future prosperity. Furthermore, it determines the decision-making and distribution of government resources, education, health care services, and urban planning. This alarming issue leaves many seeking an explanation as to what exactly is causing this phenomenon. While people may point fingers at the ever changing societal norm, evolving ideology on family structure, or to no fault but the government, this paper aims to expose the possible explanations to the plummeting birth rate in the United States of America.

The nations birth rate has fallen significantly since 2007, dropping but about 23% by 2022, measured by number of births per 1000 women [@citeAxios] and that birth rates tend to fall as based on the economy. 2007 marks the start of the most severe economic crisis the world has ever faced, spanning the years 2007 until 2009. The events of this crisis has had long lasting damage on the economy, with unemployment doubling and the crash of the housing market [@citeFDR]. These poor economic conditions and the unusually slow recovery of the economy would play a large role in the decision to have children, as an unpredictable economic environment makes people feel less secure about raising a family, thus contributing to the recorded decline in birth rates. This is just one of various factors that we will be exploring in this paper to observe any trends and correlations between societal and economic shifts and the dwindling birth rate in the US.

Throughout the rest of this paper, we will be delving into the statistics with regards to birth rates in the US and observe any trends we can find. In the data and results sections of this paper, we examine and analyze the information reported by the AEA by downloading and cleaning the data sets. After that, we will look into the results sections to look for trends and other insights that can be uncovered from our research, and finally discuss and summarize all of our findings in the conclusion.

# Data

## Data Source and Collection

The datasets for this paper were acquired through the American Economic Association's paper "The Puzzle of Falling US Birth Rates since the Great Recession" [@citeOriginalReplication], with the aid of data available from Centers for Disease Control, and Prevention (CDC) Natality data [@citeCDCNCHS] and CDC SEER U.S. Population Data [@citeCDCSeer]. The data sources were accessed on February 12th, 2024 and acts as the foundation of this paper. The data sources themselves are a collaborative effort including but not limited to the U.S. Census Bureau, the National Cancer Institute, SEER Data, CDC, and the National Center for Health Statistics (NCHS). The United States census is legally mandated by the United States Constitution which occurs every 10 years. The data is largely comprised of `numeric` values representing years, birth rates by race and ethnicity, marital status, education, age, and birth parity, or `character` values representing US states.

All data collection and analysis was done using statistical tools and data visualization program R [@citeR] and Rstudio IDE [@citeRStudio] to help streamline the workflow. The analysis was done using the R program and the following supporting packages `tidyverse` [@citeTidyverse], `haven` [@citeHaven], `ggplot2` [@citeGgplot2], `here` [@citeHere], `ggthemes` [@citeGgthemes], and `dplyr` [@citeDplyr]. We will provide more comprehensive details about the data cleaning, and analysis in the following subsections.

## Variables of Interest
Although the data contains an abundance of information, we are mainly concerned of US birth rates per year, the total female population, and various other factors including age, mother's level of education, and birth parity (number of children for a given women). As this paper focuses on birth rates in the US over the course of time, we have all the necessary and sufficient information required to proceed processing the data for our analysis.

## Data Processing

## Data Visualization


```{r graph1, fig.cap="Trend in US Birth Rates from 1980 - 2020"}
#| echo: false
#| message: false
#| warning: false
#| label: fig-1

# replicate figure 1 from the original paper
fig_1_data %>% ggplot(aes(x = year, y = brate_all)) +
  geom_line(color = "#378bd4", size = 1) +
  labs(x = "Year", y = "Births per 1,000 women age 15-44") +
  scale_y_continuous(limits = c(50,80), breaks = seq(50, 80, by = 5)) +
  scale_x_continuous(limits = c(1980,2020), breaks = seq(1980, 2020, by = 5)) +
  theme_classic()
```

```{r graph2a, fig.cap="Trends in Birth Rates by Five-year Age Group"}
#| echo: false
#| message: false
#| warning: false
#| label: fig-2a

# replicate figure 2a from the original paper
fig_2a_data_long %>% ggplot(aes(x = year, y = Birth_Rate, color = Age_Group)) +
  geom_line(size = 1) +
  labs(x = "Year", y = "Births per 1,000 women in \n relevant population subgroup", color = "Age Group") +
  scale_y_continuous(limits = c(0, 140), breaks = seq(0, 150, by = 20)) +
  scale_x_continuous(limits = c(1980, 2020), breaks = seq(1980, 2020, by = 5)) +
  geom_text(aes(x = 1985, y = 120), label = "Age 25-29", color = "#1e7837") +
  geom_text(aes(x = 1985, y = 100), label = "Age 20-24", color = "#786d1e") +
  geom_text(aes(x = 1985, y = 80), label = "Age 30-34", color = "#27a39b") +
  geom_text(aes(x = 1985, y = 58), label = "Age 15-19", color = "#f8766d") +
  geom_text(aes(x = 1985, y = 33), label = "Age 35-39", color = "#5587cf") +
  geom_text(aes(x = 1985, y = 10), label = "Age 40-44", color = "#d45dce") +
  theme_classic() +
  theme(legend.position = "none")
```

```{r graph2b, fig.cap="Trends in Birth Rates by Mother's Level of Education (ages 20-44)"}
#| echo: false
#| message: false
#| warning: false
#| label: fig-2b
# replicate figure 2d from the original paper
fig_2d_data_long %>% ggplot(aes(x = year, y = Birth_Rate, color = Education_Level)) +
  geom_line(size = 1) +
  labs(x = "Year", y = "Births per 1,000 women in \n relevant population subgroup", color = "Education Level") +
  scale_y_continuous(limits = c(0, 140), breaks = seq(0, 150, by = 20)) +
  scale_x_continuous(limits = c(1990, 2020), breaks = seq(1990, 2020, by = 5)) +
  geom_text(aes(x = 1993, y = 112), label = "No high school degree", color = "#668a38", hjust = 0) +
  geom_text(aes(x = 1993, y = 82), label = "College graduate", color = "#f8766d", hjust = 0) +
  theme_classic() +
  geom_text(aes(x = 1993, y = 62), label = "High school graduate", color = "#00bfc4", hjust = 0) +
  geom_text(aes(x = 1993, y = 45), label = "Some college", color = "#b873c7", hjust = 0) +
  theme_classic() +
  theme(legend.position = "none")
```

```{r graph2c, fig.cap="Trends in Birth Rates by Parity (ages 15-44)"}
#| echo: false
#| message: false
#| warning: false
#| label: fig-2c

# replicate figure 2f from the original paper
merged_data_long %>% ggplot(aes(x = year, y = round(Birth_Rate, digits = 1), color = Parity)) +
  geom_line(size = 1, stat = "summary", fun = mean) +
  labs(x = "Year", y = "Births per 1,000 women in \n relevant population subgroup", color = "Parity") +
  scale_y_continuous(limits = c(0, 40), breaks = seq(0, 40, by = 10)) +
  scale_x_continuous(limits = c(1990, 2020), breaks = seq(1990, 2020, by = 5)) +
  geom_text(aes(x = 1993, y = 28), label = "First birth", color = "#f8766d", hjust = 0) +
  geom_text(aes(x = 1993, y = 23), label = "Second birth", color = "#00bfc4", hjust = 0) +
  geom_text(aes(x = 1993, y = 12.5), label = "Third Birth", color = "#b873c7", hjust = 0) +
  geom_text(aes(x = 1993, y = 8.5), label = "Fourth+ birth", color = "#668a38", hjust = 0) +
  theme_classic() +
  theme(legend.position = "none")
```

```{r graph3, fig.cap="Children Ever Born by Mother's Age and Birth Cohort"}
#| echo: false
#| message: false
#| warning: false
#| label: fig-3

# replicate figure 5 from the original paper
# code to replicate figure 5 from: https://github.com/KCtt457/us-birth-rates-decline
nchs_cohort_data %>%
  ggplot(aes(x = mage,
             y = cum_brate,
             color = cohort_years)) +
  geom_line(size = 1) +
  labs(x = "Mother's age", y = "Children ever born", color = "Birth cohorts") +
  scale_y_continuous(limits=c(0, 2.5), breaks=seq(0, 2.5, by = .5)) +
  scale_x_continuous(limits=c(15, 44), breaks=seq(15, 44, by = 1)) +
  theme_classic() + 
  theme(legend.background = element_blank(), legend.box.background = element_rect(), legend.position = c(0.85,0.4), axis.text.x = element_text(angle = 45, hjust = 1))
```
# References


